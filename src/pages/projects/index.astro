---
// src/pages/projects/index.astro
import Layout from '../../layouts/Layout.astro';
import ProjectsGrid from '../../components/ProjectsGrid';
import { Layers } from 'lucide-react';
import { getProjects } from '../../lib/db';

const db = Astro.locals.runtime?.env?.DB;

let projects: any[] = [];

if (db) {
  projects = await getProjects(db);
}

const PROJECTS_PAGE_DATA = {
  hero: {
    badge: 'Portfolio Showcase',
    title: {
      line1: 'Building',
      highlight: 'Digital Reality.'
    },
    description: 'Explore a curated collection of my latest work, ranging from complex web applications to intuitive mobile experiences. Each project represents a unique challenge solved with clean code.'
  }
};
---

<Layout title="Projects" description={PROJECTS_PAGE_DATA.hero.description}>
    {/* HERO SECTION */}
    <section class="relative pt-32 pb-12 px-6 max-w-7xl mx-auto overflow-hidden">
        <div class="absolute top-0 right-0 w-[500px] h-[500px] bg-primary/10 blur-[120px] rounded-full -z-10 pointer-events-none"></div>
        <div class="absolute bottom-0 left-0 w-[300px] h-[300px] bg-accent/10 blur-[100px] rounded-full -z-10 pointer-events-none"></div>

        <div class="grid grid-cols-1 lg:grid-cols-2 gap-12 items-center">
            <div class="space-y-6">
                <div class="inline-flex items-center gap-2 py-1.5 px-4 rounded-full bg-white/5 border border-white/10 text-primary text-xs font-bold uppercase tracking-wider mb-2">
                    <Layers size={14} />
                    {PROJECTS_PAGE_DATA.hero.badge}
                </div>
                <h1 class="text-5xl md:text-7xl font-bold text-white tracking-tight leading-[1.1]">
                    {PROJECTS_PAGE_DATA.hero.title.line1} <br/>
                    <span class="text-transparent bg-clip-text bg-gradient-to-r from-[#6366F1] to-[#A312CB]">{PROJECTS_PAGE_DATA.hero.title.highlight}</span>
                </h1>
                <p class="text-lg text-text-body max-w-lg leading-relaxed">
                    {PROJECTS_PAGE_DATA.hero.description}
                </p>
            </div>
        </div>
    </section>

    {/* MAIN GRID SECTION */}
    <section class="px-6 max-w-7xl mx-auto pb-20 pt-10">
        <div class="flex flex-col md:flex-row justify-between items-end mb-12 border-b border-white/10 pb-6">
            <h2 class="text-3xl font-bold text-white">All Projects</h2>
            <p class="text-text-muted text-sm mt-2 md:mt-0">Showing {projects.length} results</p>
        </div>
        
        <ProjectsGrid client:load projects={projects} />
    </section>
</Layout>
