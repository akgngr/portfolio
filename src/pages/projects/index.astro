---
// src/pages/projects/index.astro
import Layout from '../../layouts/Layout.astro';
import ProjectsGrid from '../../components/ProjectsGrid';
import { getProjects } from '../../lib/db';
import { Layers, Code, Zap, Smartphone } from 'lucide-react';

const db = Astro.locals.runtime?.env?.DB;

let projects: any[] = [];

if (db) {
  projects = await getProjects(db);
}

const PROJECTS_PAGE_DATA = {
  hero: {
    badge: 'Portfolio Showcase',
    title: {
      line1: 'Building',
      highlight: 'Digital Reality.'
    },
    description: 'Explore a curated collection of my latest work, ranging from complex web applications to intuitive mobile experiences. Each project represents a unique challenge solved with clean code.'
  }
};
---

<Layout title="Projects" description={PROJECTS_PAGE_DATA.hero.description}>
    {/* HERO SECTION */}
    <section class="relative pt-32 pb-12 px-6 max-w-7xl mx-auto overflow-hidden">
        <div class="absolute top-0 right-0 w-125 h-125 bg-primary/10 blur-[120px] rounded-full -z-10 pointer-events-none"></div>
        <div class="absolute bottom-0 left-0 w-75 h-75 bg-accent/10 blur-[100px] rounded-full -z-10 pointer-events-none"></div>

        <div class="grid grid-cols-1 lg:grid-cols-2 gap-12 items-center">
            <div class="space-y-6">
                <div class="inline-flex items-center gap-2 py-1.5 px-4 rounded-full bg-white/5 border border-white/10 text-primary text-xs font-bold uppercase tracking-wider mb-2">
                    <Layers size={14} />
                    {PROJECTS_PAGE_DATA.hero.badge}
                </div>
                <h1 class="text-5xl md:text-7xl font-bold text-white tracking-tight leading-[1.1]">
                    {PROJECTS_PAGE_DATA.hero.title.line1} <br/>
                    <span class="text-transparent bg-clip-text bg-linear-to-r from-primary to-accent">{PROJECTS_PAGE_DATA.hero.title.highlight}</span>
                </h1>
                <p class="text-lg text-text-body max-w-lg leading-relaxed">
                    {PROJECTS_PAGE_DATA.hero.description}
                </p>
            </div>
        {/* Right Visuals (Stats/3D Cards) */}
        <div class="relative h-100 w-full hidden lg:block">
            {/* Floating Card 1: Web */}
            <div class="absolute top-10 right-10 z-20 bg-[#1e212f]/80 backdrop-blur-xl border border-white/10 p-6 rounded-2xl shadow-2xl transform rotate-3 hover:rotate-0 transition-transform duration-500 w-64">
                    <div class="flex items-center gap-4 mb-4">
                        <div class="p-3 bg-primary/20 rounded-lg text-primary">
                            <Code size={24} />
                        </div>
                        <div>
                            <h4 class="text-white font-bold">Web Apps</h4>
                            <span class="text-xs text-textMuted">React / Next.js</span>
                        </div>
                    </div>
                    <div class="h-2 w-full bg-white/5 rounded-full overflow-hidden">
                        <div class="h-full bg-primary w-[85%]" />
                    </div>
            </div>

            {/* Floating Card 2: Mobile */}
            <div class="absolute top-40 right-40 z-10 bg-[#1e212f]/80 backdrop-blur-xl border border-white/10 p-6 rounded-2xl shadow-2xl transform -rotate-6 hover:rotate-0 transition-transform duration-500 w-64">
                    <div class="flex items-center gap-4 mb-4">
                        <div class="p-3 bg-accent/20 rounded-lg text-accent">
                            <Smartphone size={24} />
                        </div>
                        <div>
                            <h4 class="text-white font-bold">Mobile</h4>
                            <span class="text-xs text-textMuted">React Native</span>
                        </div>
                    </div>
                    <div class="h-2 w-full bg-white/5 rounded-full overflow-hidden">
                        <div class="h-full bg-accent w-[70%]" />
                    </div>
            </div>

            {/* Floating Card 3: Performance */}
            <div class="absolute bottom-10 right-20 z-30 bg-surface border border-white/10 p-4 rounded-xl shadow-xl flex items-center gap-4 animate-bounce-custom">
                <div class="bg-green-500/20 p-2 rounded-full text-green-500">
                    <Zap size={20} fill="currentColor" />
                </div>
                <div>
                    <span class="block text-xl font-bold text-white">100%</span>
                    <span class="text-xs text-textMuted uppercase font-bold">Performance</span>
                </div>
            </div>
        </div>
        </div>
    </section>

    {/* MAIN GRID SECTION */}
    <section class="px-6 max-w-7xl mx-auto pb-20 pt-10">
        <div class="flex flex-col md:flex-row justify-between items-end mb-12 border-b border-white/10 pb-6">
            <h2 class="text-3xl font-bold text-white">All Projects</h2>
            <p class="text-text-muted text-sm mt-2 md:mt-0">Showing {projects.length} results</p>
        </div>
        
        <ProjectsGrid client:load projects={projects} />
    </section>
</Layout>
